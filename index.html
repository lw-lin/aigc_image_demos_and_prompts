<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <script>
        // 表格数据 JSON
        const tableData = {
            "rows": [
                {
                    "category": "A1_文艺创作类",
                    "cells": [
                        { "image": "details/A1_文艺创作类/bbb/img.jpg", "desc": "bbb", "tooltip": { "source": "【source】https://mp.weixin.qq.com/s/z49EVjaOQVoqWN1SjpjbNw", "prompt": "【prompt】创建一个中文信息图，展示“蛋炒饭”的完整制作步骤。画面清晰、有层次感，采用料理教学海报风格，结构简洁，图文结合。\n【整体风格】\n- 扁平信息图\n- 高对比配色、干净留白\n- 卡片式步骤模块\n- 真实食材插画 + 线条图标\n- 大标题 + 小步骤说明\n【内容结构】\n标题：蛋炒饭 · 可视化教程\n一、准备食材（配图：装在碗里的米饭、鸡蛋、葱、盐、油）\n- 冷饭一碗\n- 鸡蛋两个\n- 葱花少许\n- 盐、胡椒适量\n二、打蛋（配图：蛋液碗）\n- 将鸡蛋打散，加入少许盐\n三、热锅煎蛋（配图：平底锅、金黄色蛋液）\n- 热锅热油，倒入蛋液\n- 蛋液刚凝固时迅速铲散\n四、加入米饭（配图：锅中米饭与蛋混合）\n- 加入冷饭，快速翻炒\n- 让每粒米饭裹上蛋液\n五、调味（配图：盐、胡椒、酱油）\n- 加盐、胡椒\n- 可少量酱油调色（非必选）\n六、加入葱花（配图：葱花洒入锅中）\n- 临出锅前加入葱花\n- 再翻炒几下\n七、完成（配图：成品蛋炒饭、金黄松散）\n- 米饭颗粒分明、金黄油亮\n- 装盘即可享用\n【画面风格关键词】\n高清、质感插画、明亮色调、料理手册风、可视化教学、简单易懂、结构严谨、中文信息图", "extra_info": "【extra_info】" } },
                        { "image": "details/A1_文艺创作类/哈尔滨主题封面/img.jpg", "desc": "哈尔滨主题封面", "tooltip": { "source": "【source】https://mp.weixin.qq.com/s/z49EVjaOQVoqWN1SjpjbNw", "prompt": "【prompt】生成一张冬季哈尔滨主题封面图，风格明亮、有质感、氛围高级、视觉冲击力强。主体为上传的美女照片，整体画面要围绕“哈尔滨冬天”的氛围展开。\n【画面元素】\n- 雾凇、白雪、冰晶、倒挂冰柱\n- 哈尔滨中央大街 / 索菲亚教堂轮廓（可做虚化背景）\n- 冰蓝色冷光 + 暖色点光（制造反差）\n- 雾气、光粒、雪花动态感\n- 冰面反光、柔焦灯光、氛围光\n【人物处理】\n- 上传的美女作为主视觉，置于画面中心或偏右\n- 周围加入轻微雪花、冰晶折射光\n- 人物保持清晰、肤色自然、光线干净\n- 不改变五官，但优化整体光影与质感\n【封面文字（小红书风）】\n- 主标题（大字号、白色或金色描边）：\n「哈尔滨的冬天，也太好拍了吧！❄️」\n- 副标题（小字、横向排）：\n「冰雪城市 · 冬季旅行大片感」\n- 左上角加：\n「#哈尔滨 #冬季旅行 #女生写真」\n【风格要求】\n- 高清 / 质感拉满 / 冰蓝调 + 金色点缀\n- 封面设计风格（极简、干净、有氛围）\n- 光影柔和、画面不拥挤、标题醒目易读\n- 适合封面缩略图场景，有高点击视觉力\n【整体视觉参考】\n电影级冬日氛围、日韩城市雪景、轻松治愈、高质感封面图、突出人物与雪景的反差。", "extra_info": "【extra_info】" } }
                    ]
                },
                {
                    "category": "B1_教程:信息图表类",
                    "cells": [
                        { "image": "details/B1_教程:信息图表类/dd/img.jpg", "desc": "dd", "tooltip": { "source": "【source】https://mp.weixin.qq.com/s/z49EVjaOQVoqWN1SjpjbNw", "prompt": "【prompt】提示词：创建一个中文信息图，展示“蛋炒饭”的完整制作步骤。画面清晰、有层次感，采用料理教学海报风格，结构简洁，图文结合。\n【整体风格】\n- 扁平信息图\n- 高对比配色、干净留白\n- 卡片式步骤模块\n- 真实食材插画 + 线条图标\n- 大标题 + 小步骤说明\n【内容结构】\n标题：蛋炒饭 · 可视化教程\n一、准备食材（配图：装在碗里的米饭、鸡蛋、葱、盐、油）\n- 冷饭一碗\n- 鸡蛋两个\n- 葱花少许\n- 盐、胡椒适量\n二、打蛋（配图：蛋液碗）\n- 将鸡蛋打散，加入少许盐\n三、热锅煎蛋（配图：平底锅、金黄色蛋液）\n- 热锅热油，倒入蛋液\n- 蛋液刚凝固时迅速铲散\n四、加入米饭（配图：锅中米饭与蛋混合）\n- 加入冷饭，快速翻炒\n- 让每粒米饭裹上蛋液\n五、调味（配图：盐、胡椒、酱油）\n- 加盐、胡椒\n- 可少量酱油调色（非必选）\n六、加入葱花（配图：葱花洒入锅中）\n- 临出锅前加入葱花\n- 再翻炒几下\n七、完成（配图：成品蛋炒饭、金黄松散）\n- 米饭颗粒分明、金黄油亮\n- 装盘即可享用\n【画面风格关键词】\n高清、质感插画、明亮色调、料理手册风、可视化教学、简单易懂、结构严谨、中文信息图", "extra_info": "【extra_info】" } },
                        { "image": "details/B1_教程:信息图表类/蛋炒饭/img.jpg", "desc": "蛋炒饭", "tooltip": { "source": "【source】https://mp.weixin.qq.com/s/z49EVjaOQVoqWN1SjpjbNw", "prompt": "【prompt】创建一个中文信息图，展示“蛋炒饭”的完整制作步骤。画面清晰、有层次感，采用料理教学海报风格，结构简洁，图文结合。\n【整体风格】\n- 扁平信息图\n- 高对比配色、干净留白\n- 卡片式步骤模块\n- 真实食材插画 + 线条图标\n- 大标题 + 小步骤说明\n【内容结构】\n标题：蛋炒饭 · 可视化教程\n一、准备食材（配图：装在碗里的米饭、鸡蛋、葱、盐、油）\n- 冷饭一碗\n- 鸡蛋两个\n- 葱花少许\n- 盐、胡椒适量\n二、打蛋（配图：蛋液碗）\n- 将鸡蛋打散，加入少许盐\n三、热锅煎蛋（配图：平底锅、金黄色蛋液）\n- 热锅热油，倒入蛋液\n- 蛋液刚凝固时迅速铲散\n四、加入米饭（配图：锅中米饭与蛋混合）\n- 加入冷饭，快速翻炒\n- 让每粒米饭裹上蛋液\n五、调味（配图：盐、胡椒、酱油）\n- 加盐、胡椒\n- 可少量酱油调色（非必选）\n六、加入葱花（配图：葱花洒入锅中）\n- 临出锅前加入葱花\n- 再翻炒几下\n七、完成（配图：成品蛋炒饭、金黄松散）\n- 米饭颗粒分明、金黄油亮\n- 装盘即可享用\n【画面风格关键词】\n高清、质感插画、明亮色调、料理手册风、可视化教学、简单易懂、结构严谨、中文信息图", "extra_info": "【extra_info】" } }
                    ]
                }
            ]
        };

        // 动态生成表格
        function generateTable() {
            const table = document.createElement('table');
            const COLUMNS_PER_ROW = 5; // 每行固定 5 列
            
            tableData.rows.forEach((row, rowIndex) => {
                const cells = row.cells || [];
                const rowsNeeded = Math.ceil(cells.length / COLUMNS_PER_ROW); // 当前行的cells需要多少行
                
                // 如果当前行有 category，需要计算 rowspan
                // rowspan = 当前行的cells需要的行数
                let categoryRowspan = null;
                if (row.category) {
                    categoryRowspan = rowsNeeded;
                }
                
                // 将当前行的cells按每行5个分组
                for (let rowOffset = 0; rowOffset < rowsNeeded; rowOffset++) {
                    const tr = document.createElement('tr');
                    
                    // 处理左侧列 - 只在第一行创建，并设置 rowspan
                    if (row.category && rowOffset === 0) {
                        const leftTd = document.createElement('td');
                        leftTd.textContent = row.category;
                        leftTd.setAttribute('rowspan', categoryRowspan);
                        tr.appendChild(leftTd);
                    }
                    
                    // 计算当前行应该显示的cells范围
                    const startIndex = rowOffset * COLUMNS_PER_ROW;
                    const endIndex = Math.min(startIndex + COLUMNS_PER_ROW, cells.length);
                    
                    // 处理当前行的单元格
                    for (let i = startIndex; i < endIndex; i++) {
                        const cell = cells[i];
                        if (!cell || !cell.image || !cell.tooltip) {
                            console.error(`第 ${rowIndex + 1} 行第 ${i + 1} 列的单元格数据不完整`, cell);
                            // 创建空单元格
                            const td = document.createElement('td');
                            tr.appendChild(td);
                            continue;
                        }
                        
                        const td = document.createElement('td');
                        
                        const cellContent = document.createElement('div');
                        cellContent.className = 'cell-content';
                        
                        const img = document.createElement('img');
                        img.src = cell.image;
                        img.alt = '图片';
                        cellContent.appendChild(img);
                        
                        const detailText = document.createElement('span');
                        detailText.className = 'detail-text';
                        detailText.textContent = cell.desc || 'detail';
                        
                        const tooltip = document.createElement('div');
                        tooltip.className = 'tooltip';
                        const source = cell.tooltip.source || '';
                        const prompt = cell.tooltip.prompt || '';
                        const extra_info = cell.tooltip.extra_info || '';
                        tooltip.textContent = source + '\n\n' + prompt + '\n\n' + extra_info;
                        
                        detailText.appendChild(tooltip);
                        cellContent.appendChild(detailText);
                        
                        td.appendChild(cellContent);
                        tr.appendChild(td);
                    }
                    
                    // 如果单元格不足 5 个，补充空单元格
                    for (let i = endIndex - startIndex; i < COLUMNS_PER_ROW; i++) {
                        const td = document.createElement('td');
                        tr.appendChild(td);
                    }
                    
                    table.appendChild(tr);
                }
            });
            
            return table;
        }

        // 调整 tooltip 位置，避免超出屏幕
        function adjustTooltipPosition(tooltip, trigger) {
            // 重置样式
            tooltip.classList.remove('tooltip-below');
            tooltip.style.left = '';
            tooltip.style.right = '';
            tooltip.style.top = '';
            tooltip.style.bottom = '';
            tooltip.style.transform = 'translateX(-50%)';
            
            // 使用 requestAnimationFrame 确保 tooltip 已经显示
            requestAnimationFrame(function() {
                const tooltipRect = tooltip.getBoundingClientRect();
                const triggerRect = trigger.getBoundingClientRect();
                const viewportWidth = window.innerWidth;
                const viewportHeight = window.innerHeight;
                
                // 检测是否超出顶部（默认显示在上方）
                const spaceAbove = triggerRect.top;
                const spaceBelow = viewportHeight - triggerRect.bottom;
                const tooltipHeight = tooltipRect.height;
                
                // 如果上方空间不足，且下方空间足够，则显示在下方
                if (spaceAbove < tooltipHeight + 20 && spaceBelow > tooltipHeight + 20) {
                    tooltip.classList.add('tooltip-below');
                }
                
                // 重新计算位置
                const newTooltipRect = tooltip.getBoundingClientRect();
                
                // 调整左右位置
                let leftOffset = 0;
                if (newTooltipRect.left < 10) {
                    leftOffset = 10 - newTooltipRect.left;
                } else if (newTooltipRect.right > viewportWidth - 10) {
                    leftOffset = viewportWidth - 10 - newTooltipRect.right;
                }
                
                if (leftOffset !== 0) {
                    tooltip.style.transform = `translateX(calc(-50% + ${leftOffset}px))`;
                }
            });
        }

        // 页面加载完成后生成表格并设置 tooltip 位置调整
        document.addEventListener('DOMContentLoaded', function() {
            const table = generateTable();
            document.body.appendChild(table);
            
            // 为所有 tooltip 添加位置调整和显示/隐藏控制
            const detailTexts = document.querySelectorAll('.detail-text');
            detailTexts.forEach(detailText => {
                const tooltip = detailText.querySelector('.tooltip');
                if (tooltip) {
                    let hideTimeout = null;
                    
                    // 显示 tooltip
                    function showTooltip() {
                        if (hideTimeout) {
                            clearTimeout(hideTimeout);
                            hideTimeout = null;
                        }
                        tooltip.style.display = 'block';
                        adjustTooltipPosition(tooltip, detailText);
                    }
                    
                    // 隐藏 tooltip（带延迟）
                    function hideTooltip() {
                        hideTimeout = setTimeout(function() {
                            tooltip.style.display = 'none';
                            hideTimeout = null;
                        }, 100); // 100ms 延迟，给鼠标时间移动到 tooltip
                    }
                    
                    // 取消隐藏
                    function cancelHide() {
                        if (hideTimeout) {
                            clearTimeout(hideTimeout);
                            hideTimeout = null;
                        }
                    }
                    
                    // 当鼠标进入文字时显示
                    detailText.addEventListener('mouseenter', showTooltip);
                    // 当鼠标离开文字时准备隐藏（但给时间移动到 tooltip）
                    detailText.addEventListener('mouseleave', hideTooltip);
                    
                    // 当鼠标进入 tooltip 时取消隐藏并调整位置
                    tooltip.addEventListener('mouseenter', function() {
                        cancelHide();
                        showTooltip();
                    });
                    // 当鼠标离开 tooltip 时隐藏
                    tooltip.addEventListener('mouseleave', function() {
                        tooltip.style.display = 'none';
                    });
                }
            });
        });
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>图片详情表格</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            background-color: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        td {
            padding: 20px;
            text-align: center;
            border: 1px solid #ddd;
            vertical-align: middle;
        }
        
        .cell-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }
        
        .cell-content img {
            max-width: 150px;
            max-height: 150px;
            object-fit: contain;
        }
        
        .detail-text {
            color: #999;
            cursor: help;
            position: relative;
        }
        
        .tooltip {
            display: none;
            position: absolute;
            bottom: calc(100% + 5px);
            left: 50%;
            transform: translateX(-50%);
            background-color: #333;
            color: white;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 12px;
            z-index: 1000;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            text-align: left;
            white-space: pre-line;
            user-select: text;
            -webkit-user-select: text;
            -moz-user-select: text;
            -ms-user-select: text;
            pointer-events: auto;
            min-width: 100px;
            max-width: 400px;
            max-height: 300px;
            overflow-y: auto;
            word-wrap: break-word;
        }
        
        .tooltip.tooltip-below {
            bottom: auto;
            top: calc(100% + 10px);
        }
        
        .tooltip::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 5px solid transparent;
            border-top-color: #333;
            margin-top: -1px;
        }
        
        .tooltip.tooltip-below::after {
            top: auto;
            bottom: 100%;
            border-top-color: transparent;
            border-bottom-color: #333;
            margin-top: 0;
            margin-bottom: -1px;
        }
        
    </style>
</head>
<body>
</body>
</html>

